% -*- latex -*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%
%%%% This TeX file is part of the course
%%%% Introduction to Scientific Programming in C++/Fortran2003
%%%% copyright 2017-9 Victor Eijkhout eijkhout@tacc.utexas.edu
%%%%
%%%% string.tex : text strings
%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\Level 0 {Characters}

\begin{block}{Characters and ints}
  \label{sl:chardef}
  \begin{itemize}
  \item Type \indextermttdef{char};
  \item represents `7-bit ASCII': printable and (some) unprintable
    characters.
  \item Single quotes: \n{char c = 'a'}
  \end{itemize}
\end{block}

\begin{block}{Char / int equivalence}
  \label{sl:int-char}
  Equivalent to (short) integer:
  %
  \snippetwithoutput{intchar}{string}{intchar}
  %
  Also: \n{'x'-'a'} is distance \n{a--x}
\end{block}

\begin{exercise}
  \label{ex:print-ichar}
  Write a program that accepts an integer $1\cdots26$ and prints the
  so-manieth letter of the alphabet.

  Extend your program so that if the input is negative, it prints the
  minus-so-manieth uppercase letter of the alphabet.
\end{exercise}

\Level 0 {Basic string stuff}
\label{sec:string}

\begin{block}{String declaration}
  \label{sl:string-declare}
\begin{lstlisting}
#include <string>
using std::string;

// .. and now you can use `string'
\end{lstlisting}
(Do not use the C legacy mechanisms.)
\end{block}

\begin{block}{String creation}
  \label{sl:string-create}
  A \indexterm{string} variable contains a string of characters.
\begin{lstlisting}
string txt;
\end{lstlisting}
You can initialize the string variable or assign it dynamically:
\begin{lstlisting}
string txt{"this is text"};
string moretxt("this is also text");
txt = "and now it is another text";
\end{lstlisting}
\end{block}

Normally, quotes indicate the start and end of a string. So what if
you want a string with quotes in it?

\begin{block}{Quotes in strings}
  \label{sl:string-quote}
  You can escape a quote, or indicate that the whole string is to be
  taken literally:
  %
  \snippetwithoutput{quotestring}{string}{quote}
\end{block}

\begin{block}{Concatenation}
  \label{sl:string-plus}
  Strings can be \emph{concatenated}\index{string!concatenation}:
\begin{lstlisting}
txt = txt1+txt2;
txt += txt3;
\end{lstlisting}
\end{block}

\begin{block}{String indexing}
  \label{sl:string-vector}
  You can query the \emph{size}\index{string!size}:
\begin{lstlisting}
int txtlen = txt.size();
\end{lstlisting}
or use subscripts:
\begin{lstlisting}
cout << "The second character is <<" << 
        txt[1] << ">>" << endl;
\end{lstlisting}
\end{block}

\begin{block}{Ranging over a string}
  \label{sl:string-index}
  Ranging by index:
  %
  \snippetwithoutput{stringindex}{string}{stringindex}
  %
  New syntax: range-based for
  %
  \snippetwithoutput{stringrange}{string}{stringrange}
\end{block}

\begin{block}{Range with reference}
  \label{sl:string-index-ref}
  Range-based for makes a copy of the element\\
  You can also get a reference:
  %
  \snippetwithoutput{stringrangeset}{string}{stringrangeset}
\end{block}

\begin{block}{Iterating over a string}
\begin{lstlisting}
for ( auto c : some_string)
  // do something with the character 'c'
\end{lstlisting}
\end{block}

\begin{review}
  \label{q:string}
  True or false?
  \begin{itemize}
  \item \verb+'0'+ is a valid value for a \n{char} variable
  \item \verb+"0"+ is a valid value for a \n{char} variable
  \item \verb+"0"+ is a valid value for a \n{string} variable
  \item \verb/'a'+'b'/ is a valid value for a \n{char} variable
  %\item \verb/'a'+'b'/ is a valid value for a \n{string} variable
  \end{itemize}
\end{review}

\begin{exercise}
  \label{ex:caesar}
  The oldest method of writing secret messages is the
  \indexterm{Caesar cypher}. You would take an integer~$s$ and rotate every character 
  of the text over that many positions:
  \[ s\equiv3\colon \hbox{"acdz" $\Rightarrow$ "dfgc"}. \]
  Write a program that accepts an integer and a string, and display
  the original string rotated over that many positions.
\end{exercise}
\begin{exercise}
  \label{ex:caesar-decrypt}
  (this continues exercise~\ref{ex:caesar})\\
  If you find a message encrypted with the Caesar cipher, can you
  decrypt it? Take your inspiration from the
  \indextermsub{Sherlock}{Holmes} story `The Adventure of the Dancing
  Men', where he uses the fact that `e' is the most common letter.

  Can you implement a more general letter permutation cipher, and
  break it with the `dancing men' approach?
\end{exercise}

\begin{block}{More vector methods}
  \label{sl:string-vector-methods}
  Other methods for the vector class apply: \n{insert}, \n{empty},
  \n{erase}, \n{push_back}, et cetera.

  Methods only for \n{string}: \n{find} and such.

  \url{http://en.cppreference.com/w/cpp/string/basic_string}
\end{block}

\begin{exercise}
  \label{ex:printdigits}
  Write a function to print out the digits of a number: \n{156} should
  print \n{one five six}.
  You need to convert a digit to a string first; can you think of more
  than one way to do that?
  % Use a vector or array of strings, containing the names of the digits.

  Start by writing a program that reads a single digit and prints its name.

  For the full program it is easiest to generate the  digits last-to-first.
  Then figure out how to print them reversed.
\end{exercise}

\begin{exercise}
  \label{ex:printnumber}
  Write a function to convert an integer to a string: the input
  \n{215} should give \n{two hundred fifteen}, et cetera.
\end{exercise}

\begin{exercise}
  Write a pattern matcher, where a period~\n{.} matches any one
  character, and \n{x*} matches any number of~`\n{x}' characters.

  For example:
  \begin{itemize}
  \item The string \n{abc} matches \n{a.c} but \n{abbc} doesn't.
  \item The string \n{abbc} matches \n{ab*c}, as does \n{ac}, but
    \n{abzbc} doesn't.
  \end{itemize}
\end{exercise}

\Level 0 {Conversion}

\n{to_string}

\Level 0 {C strings}
\label{sec:cstring}
\index{C!string|(}

In C a string is essentially an array of characters. C~arrays don't
store their length, but strings do have functions that implicitly or
explicitly rely on this knowledge, so they have a terminator
character: ASCII \indextermtt{NULL}. C~strings are called
\emph{null-terminated}\index{string!null-terminated} for this reason.

\index{C!string|)}
